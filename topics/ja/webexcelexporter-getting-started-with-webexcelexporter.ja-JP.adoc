////

|metadata|
{
    "name": "webexcelexporter-getting-started-with-webexcelexporter",
    "controlName": ["WebExcelExporter"],
    "tags": ["Exporting","Getting Started","Grids"],
    "guid": "d8c49235-d9f7-409f-91ff-52f31f66dd64",  
    "buildFlags": [],
    "createdOn": "2010-06-06T07:46:53.3786939Z"
}
|metadata|
////

= WebExcelExporter を使用した作業の開始

WebTabExcelExporter™ コンポーネント、およびその主要な特性と機能について説明します。

== 達成すること

WebDataGrid/WebHierarchicalDataGrid データを Excel™ ファイル形式にエクスポートするように WebExcelExporter を設定および使用する方法を学習します。

== 始める前に

ここに示すサンプルをコンパイルおよび実行するためには、NetAdvatage for ASP.NET v. 10.2 をインストールする必要があります。SQL サーバー（Express またはその他任意のエディション）の実行中のインスタンスも必要となりますが、SQL サーバーのインスタンスに NorthWind データベースを添付することも必要となります。 link:http://msdn.microsoft.com/en-us/library/aa276825(SQL.80).aspx[http://msdn.microsoft.com/en-us/library/aa276825%28SQL.80%29.aspx] にある指示に従い NorthWind データベースをインストールするか、 link:http://www.microsoft.com/downloads/details.aspx?familyid=06616212-0356-46a0-8da2-eebc53a68034&displaylang=en[http://www.microsoft.com/downloads/details.aspx?familyid=06616212-0356-46a0-8da2-eebc53a68034&displaylang=en] から直接データベースをダウンロードすることができます。

次の手順を実行します

[start=1]
. WebDataGrid をデータ ソースにバインドして Web ページ（ASP.NET Web フォーム）を作成します。

*HTML の場合:*

----
<ig:WebDataGrid runat="server" ID="wdgCustomers" 
        DataSourceID="SqlDsCustomers" 
        DataKeyFields="CustomerID" 
        AutoGenerateColumns="
        >
            <Columns>
                <ig:BoundDataField Key="Country" DataFieldName="Country" Header-Text="Country" />
                <ig:BoundDataField Key="City" DataFieldName="City" Header-Text="City" />
                <ig:BoundDataField Key="CompanyName" DataFieldName="CompanyName" Header-Text="Company" />
                <ig:BoundDataField Key="ContactName" DataFieldName="ContactName" Header-Text="Contact" />
                <ig:BoundDataField Key="Phone" DataFieldName="Phone" Header-Text="Phone" />
            </Columns>
        </ig:WebDataGrid>
        <asp:SqlDataSource runat="server"ID="SqlDsCustomers"ConnectionString="<%$ ConnectionStrings:NorthwindConnectionString %>" SelectCommand="SELECT * FROM [Customers] ORDER BY [Country]">
        </asp:SqlDataSource>
----

[start=2]
. WebExcelExporter コントロールを Visual Studio Toolbox からページにドラッグします。

.. WebExcelExporter の ExportMode プロパティを Download に設定します。
.. コントロールの ID プロパティを WebExcelExporter に設定します。
.. コントロールの DownloadName プロパティを "ExportedData" に設定します。

*HTML の場合:*

----
<ig:WebExcelExporter runat="server" ID="WebExcelExporter" ExportMode ="Download" DownloadName="ExportedData" />
----

[start=3]
. Button コントロールを Visual Studio Toolbox からページにドラッグします。

.. ボタンの ID プロパティを btnExport に設定します。
.. コントロールの Text プロパティを "Export Data" に設定します。
.. コントロールの OnClick を "btnExport_Click" に設定します。
.. コード ビハインドで "btnExport_Click" ハンドラーを定義し、WebExcelExporter Export() メソッド オーバーロードのひとつを呼び出します。

[cols="a"]
|====
|コード ビハインド（C#）の場合:

|protected void btnExport_Click(object sender, EventArgs e) 

{ 

this.WebExcelExporter.Export(this.wdgCustomers); 

}

|====

*HTML の場合:*

----
<asp:Button runat="server" ID="btnExport" Text="Export Data" OnClick="btnExport_Click" />
----

[start=4]
. アプリケーションを実行します。
[start=5]
. [データのエクスポート] ボタンをクリックします。

[データのエクスポート] ボタンをクリックした後、ブラウザーで "ExportedData.xls" という名前のファイルを開くか保存するかを尋ねられます。

image::images/WebExcelExporter_Getting_Started_with_WebExcelExporter_01.png[]


注: ExportedData.xlsx ファイルは Grid の表示可能なデータしか含みません。データ ソース内の全データをエクスポートしたい場合には、『データ ソース内の全データをエクスポート』を参照してください。