////

|metadata|
{
    "name": "webgauge-move-the-bar-marker-automatically",
    "controlName": ["WebGauge"],
    "tags": ["How Do I"],
    "guid": "{269F8474-547D-40E1-AF91-43457FC0C6FC}",  
    "buildFlags": [],
    "createdOn": "0001-01-01T00:00:00Z"
}
|metadata|
////

= バー マーカーを自動的に移動

このトピックは、リニア ゲージ上のバー マーカーを自動的に移動できるように構成する方法を説明します。たとえば、温度計を表すためにリニア ゲージを作成した場合、本物の温度計をまねて水銀レベルが上下するように構成することができます。

このトピックは、リニア ゲージを作成済みであることを前提としています。ゲージを作成する方法については、 link:webgauge-getting-started-with-webgauge.html[WebGauge で作業を開始]を参照してください。

*ゲージで針マーカーを自動的に移動するには、次の手順に従ってください。*

[start=1]
. [プロパティ] ウィンドウで、RefreshInterval プロパティを 10秒に設定します。これにより、これらの間隔ごとにサーバーで AsyncRefresh イベントが発生します。
[start=2]
. 以下の例のコードは、リニア ゲージ上の針マーカーにアクセスして、値を 5 ずつ増やします。

*Visual Basic の場合：*

----
Protected Sub UltraGauge1_AsyncRefresh(ByVal sender As Object, _
  ByVal e As Infragistics.WebUI.UltraWebGauge.RefreshEventArgs) _
  Handles UltraGauge1.AsyncRefresh
	Dim gauge As LinearGauge = Me.UltraGauge1.Gauges(0)
	Dim marker As LinearGaugeMarker = gauge.Scales(0).Markers(0)
	Dim value As Integer = Convert.ToInt32(marker.Value)
	marker.Value = value + 5
End Sub
----

*C# の場合：*

----
protected void UltraGauge1_AsyncRefresh(object sender, 
  Infragistics.WebUI.UltraWebGauge.RefreshEventArgs e)
{
	LinearGauge gauge = this.UltraGauge1.Gauges[0] as LinearGauge;
	LinearGaugeMarker marker = gauge.Scales[0].Markers[0];
	int value = Convert.ToInt32(marker.Value);
	marker.Value = value+5;
}
----

[start=3]
. アプリケーションを保存して実行します。